"use strict";var codeToLocale={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"};const re_locale=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,locales={},defaultData={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:["AM","PM"],mmmm6:["Muharram","Safar","Rabiʻ I","Rabiʻ II","Jumada I","Jumada II","Rajab","Shaʻban","Ramadan","Shawwal","Dhuʻl-Qiʻdah","Dhuʻl-Hijjah"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhuʻl-Q.","Dhuʻl-H."],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function parseLocale(e){var a=re_locale.exec(e);if(a)return{lang:a[1]+(a[2]?"_"+a[2]:""),language:a[1],territory:a[2]||"",codeset:a[3]||"",modifier:a[4]||""};throw new SyntaxError("Malformed locale: ".concat(e))}function resolveLocale(e){if("number"==typeof e)return codeToLocale[65535&e]||null;var a=parseInt(e,16);return isFinite(a)&&codeToLocale[65535&a]?codeToLocale[65535&a]||null:re_locale.test(e)?e:null}function getLocale(e){var e=resolveLocale(e);let a=null;return e&&(e=parseLocale(e),a=locales[e.lang]||locales[e.language]||null),a}function createLocale(e){return Object.assign({},defaultData,e)}function addLocale(e,a){a="object"==typeof a?a:parseLocale(a);return locales[a.lang]=createLocale(e),a.language===a.lang||locales[a.language]||(locales[a.language]=createLocale(e)),locales[a.lang]}const defaultLocale=createLocale({group:","});function round(e,a){return"number"!=typeof e?e:e<0?-round(-e,a):a?round(e*(a=10**(a||0)||1),0)/a:Math.round(e)}defaultLocale.isDefault=!0,addLocale({group:",",ampm:["上午","下午"],mmmm:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["周日","周一","周二","周三","周四","周五","周六"]},"zh_CN"),addLocale({group:",",nan:"非數值",ampm:["上午","下午"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["週日","週一","週二","週三","週四","週五","週六"]},"zh_TW"),addLocale({group:",",ampm:["午前","午後"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ddd:["日","月","火","水","木","金","土"]},"ja"),addLocale({group:",",ampm:["오전","오후"],mmmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],mmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dddd:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],ddd:["일","월","화","수","목","금","토"]},"ko"),addLocale({group:",",ampm:["ก่อนเที่ยง","หลังเที่ยง"],mmmm:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],mmm:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dddd:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],ddd:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},"th"),addLocale({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","února","března","dubna","května","června","července","srpna","září","října","listopadu","prosince"],mmm:["led","úno","bře","dub","kvě","čvn","čvc","srp","zář","říj","lis","pro"],dddd:["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],ddd:["ne","po","út","st","čt","pá","so"]},"cs"),addLocale({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"da"),addLocale({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),addLocale({group:","},"en"),addLocale({decimal:",",nan:"epäluku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kesäkuuta","heinäkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kesäk.","heinäk.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),addLocale({group:" ",decimal:",",mmmm:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],mmm:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),addLocale({group:".",decimal:",",mmmm:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),addLocale({group:".",decimal:",",ampm:["π.μ.","μ.μ."],mmmm:["Ιανουαρίου","Φεβρουαρίου","Μαρτίου","Απριλίου","Μαΐου","Ιουνίου","Ιουλίου","Αυγούστου","Σεπτεμβρίου","Οκτωβρίου","Νοεμβρίου","Δεκεμβρίου"],mmm:["Ιαν","Φεβ","Μαρ","Απρ","Μαΐ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],dddd:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],ddd:["Κυρ","Δευ","Τρί","Τετ","Πέμ","Παρ","Σάβ"]},"el"),addLocale({decimal:",",ampm:["de.","du."],mmmm:["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],mmm:["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],dddd:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),addLocale({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["janúar","febrúar","mars","apríl","maí","júní","júlí","ágúst","september","október","nóvember","desember"],mmm:["jan.","feb.","mar.","apr.","maí","jún.","júl.","ágú.","sep.","okt.","nóv.","des."],dddd:["sunnudagur","mánudagur","þriðjudagur","miðvikudagur","fimmtudagur","föstudagur","laugardagur"],ddd:["sun.","mán.","þri.","mið.","fim.","fös.","lau."]},"is"),addLocale({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),addLocale({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),addLocale({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"nb"),addLocale({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],dddd:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],ddd:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."]},"pl"),addLocale({group:".",decimal:",",mmmm:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","sáb."]},"pt"),addLocale({decimal:",",nan:"не число",mmmm:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],mmm:["янв.","февр.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],dddd:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],ddd:["вс","пн","вт","ср","чт","пт","сб"]},"ru"),addLocale({decimal:",",mmmm:["januára","februára","marca","apríla","mája","júna","júla","augusta","septembra","októbra","novembra","decembra"],mmm:["jan","feb","mar","apr","máj","jún","júl","aug","sep","okt","nov","dec"],dddd:["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],ddd:["ne","po","ut","st","št","pi","so"]},"sk"),addLocale({group:".",decimal:",",ampm:["a. m.","p. m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ddd:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."]},"es"),addLocale({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],ddd:["sön","mån","tis","ons","tors","fre","lör"]},"sv"),addLocale({group:".",decimal:",",ampm:["ÖÖ","ÖS"],mmmm:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],mmm:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"]},"tr");const PRECISION=1e-10;function dec2frac(e,a,t){var n=e<0?-1:1,r=10**(a||2),o=10**(t||2);let i=Math.abs(e),s=0;var d;let l=0,u=1,m;if((e=i)%1==0)m=[e*n,1];else if(e<1e-19)m=[n,1e19];else if(1e19<e)m=[1e19*n,1];else{do{if(i=1/(i-Math.floor(i)),u=(d=u)*Math.floor(i)+s,s=d,d=l,(l=Math.floor(e*u+.5))>=r||u>=o)return[n*d,s]}while(Math.abs(e-l/u)>=PRECISION&&i!==Math.floor(i));m=[n*l,u]}return m}const defaultOptions={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},globalOptions=Object.assign({},defaultOptions);function options(e){if(e=null===e?defaultOptions:e)for(const t in e){var a;t in defaultOptions&&(a=e[t],globalOptions[t]=null==a?defaultOptions[t]:a)}return{...globalOptions}}const u_YEAR=2,u_MONTH=4,u_DAY=8,u_HOUR=16,u_MIN=32,u_SEC=64,u_DSEC=128,u_CSEC=256,u_MSEC=512,MIN_S_DATE=0,MAX_S_DATE=2958466,MIN_L_DATE=-694324,MAX_L_DATE=35830291,EPOCH_1904=-1,EPOCH_1900=1,EPOCH_1317=6,_numchars={"#":"",0:"0","?":" "},_sp_chars={"@":"text","-":"minus","+":"plus"},indexColors=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"];function minMaxPad(e,a,t){return a[t+"_max"]=e.length,a[t+"_min"]=e.replace(/#/g,"").length,a}const _pattcache={};function patternToPadding(e){if(!(e in _pattcache)){const t=[],n=e.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,e=>"?".repeat(e.length));for(let e=0;e<n.length;e++){var a=n.charAt(e);t[e]=a in _numchars?_numchars[a]:a}_pattcache[e]=t.join("")}return _pattcache[e]}function add(e,a){"string"==typeof e&&(e={type:"string",value:e=e.replace(/ /g,_numchars["?"])}),a.push(e)}function parsePart(e){const t=[],a={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:null,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:t};let n=e+"",r="int",o=!1,i=null;const s=[];let d,l,u=!1;for(;n&&!o;){if(d=/^General/i.exec(n))a.general=!0,add({type:"general"},t);else if("int"===r&&(d=/^[#?0]+(?:,[#?0]+)*/.exec(n))||"den"===r&&(d=/^[#?\d]+/.exec(n))||(d=/^[#?0]+/.exec(n)))a[r+"_pattern"].push(d[0]),add(i={type:r,num:d[0]},t);else if((d=/^\//.exec(n))&&a[r+"_pattern"].length){if(!i)throw new SyntaxError("Missing a numerator in pattern ".concat(e));a.fractions=!0,a.num_pattern.push(a[r+"_pattern"].pop()),i.type="num",r="den",add({type:"div"},t)}else if(d=/^,+/.exec(n)){var m=n.charAt(1)in _numchars;l.slice(-1)in _numchars&&(1<d[0].length||!m)?a.scale=.001**d[0].length:add(d[0],t)}else{if(d=/^;/.exec(n)){o=!0;break}if(d=/^[@+-]/.exec(n))"@"===d[0]&&(a.text=!0),add({type:_sp_chars[d[0]]},t);else if(d=/^(?:\[(h+|m+|s+)\])/i.exec(n)){var m=d[1].toLowerCase(),p=m[0];const j={type:"",size:0,date:1,raw:d[0],pad:m.length};"h"===p?(j.size=u_HOUR,j.type="hour-elap"):"m"===p?(j.size=u_MIN,j.type="min-elap"):(j.size=u_SEC,j.type="sec-elap"),a.date=a.date|j.size,s.push(j),add(j,t)}else if(d=/^(?:B2)/i.exec(n))u||(a.date_system=EPOCH_1317);else if(d=/^(?:B1)/i.exec(n))u||(a.date_system=EPOCH_1900);else if(d=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(n)){const k={type:"",size:0,date:1,raw:d[0]};var p=d[0].toLowerCase(),c=p[0];if("y"===p||"yy"===p)k.size=u_YEAR,k.type="year-short";else if("y"===c||"e"===c)k.size=u_YEAR,k.type="year";else if("b"===p||"bb"===p)k.size=u_YEAR,k.type="b-year-short";else if("b"===c)k.size=u_YEAR,k.type="b-year";else if("d"===p||"dd"===p)k.size=u_DAY,k.type="day",k.pad=/dd/.test(p);else if("ddd"===p)k.size=u_DAY,k.type="weekday-short";else if("d"===c)k.size=u_DAY,k.type="weekday";else if("h"===c)k.size=u_HOUR,k.type="hour",k.pad=/hh/i.test(p);else if("m"===c){3===p.length?(k.size=u_MONTH,k.type="monthname-short"):5===p.length?(k.size=u_MONTH,k.type="monthname-single"):4<=p.length&&(k.size=u_MONTH,k.type="monthname");const x=s[s.length-1];!k.type&&x&&!x.used&&x.size&(u_HOUR|u_SEC)&&(x.used=!0,k.size=u_MIN,k.type="min",k.pad=/mm/.test(p)),k.type||(k.size=u_MONTH,k.type="month",k.pad=/mm/.test(p),k.indeterminate=!0)}else if("s"===c){k.size=u_SEC,k.type="sec",k.pad=/ss/.test(p);const D=s[s.length-1];D&&D.size&u_MIN?k.used=!0:D&&D.indeterminate&&(delete D.indeterminate,D.size=u_MIN,D.type="min",k.used=!0)}a.date=a.date|k.size,a.date_eval=!0,s.push(k),add(k,t)}else if(d=/^(?:AM\/PM|am\/pm|A\/P)/.exec(n))a.clock=12,a.date=a.date|u_HOUR,a.date_eval=!0,add({type:"am",short:"A/P"===d[0]},t);else if(a.date&&(d=/^\.0{1,3}/i.exec(n))){var c=d[0].length-1,f=[u_SEC,u_DSEC,u_CSEC,u_MSEC][c];a.date=a.date|f,a.date_eval=!0,a.sec_decimals=Math.max(a.sec_decimals,c),add({type:"subsec",size:f,decimals:c,date:1,raw:d[0]},t)}else if((d=/^\\(.)/.exec(n))||(d=/^"([^"]*?)"/.exec(n)))add(d[1],t);else if(d=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(n))a.condition=[d[1],parseFloat(d[2],10)];else if(d=/^\[\$([^\]]+)\]/.exec(n)){var f=d[1].split("-"),h=f.length<2?"":f[f.length-1],g=f[0],g=(g&&add(g,t),resolveLocale(h)),g=(g&&(a.locale=g),parseInt(h,16));isFinite(g)&&16711680&g&&6==(g>>16&255)&&(a.date_system=EPOCH_1317),u=!0}else if(d=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(n))a.color=d[2]?indexColors[parseInt(d[2],10)]||"#000":d[1].toLowerCase();else if(!(d=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(n)))if(d=/^%/.exec(n))a.scale=100,a.percent=!0,add("%",t);else if(d=/^_(\\.|.)/.exec(n))add(" ",t);else if(d=/^\./.exec(n))add({type:"point",value:d[0]},t),a.dec_fractions=!0,r="frac";else if(d=/^[Ee]([+-]?|(?=[0#?]))/.exec(n))a.exponential=!0,a.exp_plus="+"===d[1],r="man",add({type:"exp",plus:"+"===d[1]},t);else if(!(d=/^\*(\\.|.)/.exec(n))){if(d=/^[BENn[]/.exec(n))throw new SyntaxError("Unexpected char ".concat(n.charAt(0)," in pattern ").concat(e));"("===n[0]&&(a.parens=!0),add((d=[n[0]])[0],t)}}l=d[0],n=n.slice(d?d[0].length:1)}if(a.pattern=e.slice(0,e.length-n.length),/^((?:\[[^\]]+\])+)(;|$)/.test(a.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(a.pattern)&&add({type:"text"},t),a.fractions&&a.dec_fractions||a.fractions&&a.exponential)throw new SyntaxError("Invalid pattern: ".concat(a.pattern));const _=a.int_pattern.join("");var y;a.grouping=0<=_.indexOf(","),a.grouping?2===(y=(M=_.split(",")).length)?(a.group_pri=M[1].length,a.group_sec=a.group_pri):2<y&&(a.group_pri=M[y-1].length,a.group_sec=M[y-2].length):(a.group_pri=0,a.group_sec=0),minMaxPad(_.replace(/[,]/g,""),a,"int"),minMaxPad(a.frac_pattern.join(""),a,"frac"),minMaxPad(a.man_pattern.join(""),a,"man");let b=a.num_pattern.join(""),v=a.den_pattern.join("");var M=/\?/.test(v)||/\?/.test(b);if(v=v.replace(/\d/g,M?"?":"#"),M&&(v=v.replace(/#$/g,"?")),minMaxPad(b,a,"num"),minMaxPad(v,a,"den"),M&&(b=b.replace(/#$/g,"?")),a.int_padding=patternToPadding(a.int_pattern.join("")),a.man_padding=patternToPadding(a.man_pattern.join("")),a.num_padding=patternToPadding(b),a.den_padding=patternToPadding(v),a.den_pattern.length&&(a.denominator=parseInt(a.den_pattern.join("").replace(/\D/g,""),10)),a.integer=!!a.int_pattern.join("").length,a.fractions&&t.forEach((e,a)=>{a=t[a+1];"string"===e.type&&a&&("num"===a.type?e.rule="num+int":"div"===a.type?e.rule="num":"den"===a.type&&(e.rule="den"))}),(a.date||a.general)&&(a.int_pattern.length||a.frac_pattern.length||1!==a.scale||a.text))throw new Error("Illegal format");return a.date_system||(a.date_system=EPOCH_1900),a}function parsePattern(e){const t=[];let a=!1,n,r=null,o=e,i=0,s=!1,d=0,l=0;do{if((s=parsePart(o)).condition&&(l++,a=!0),s.text){if(r)throw new Error("Unexpected partition");r=s}}while(s.locale&&(n=resolveLocale(s.locale)),t.push(s),i=";"===o.charAt(s.pattern.length)?1:0,o=o.slice(s.pattern.length+i),d++,i&&d<4&&l<3);if(2<l)throw new Error("Unexpected condition");if(i)throw new Error("Unexpected partition");if(!a){if(t.length<4&&r)for(let e=0,a=t.length;e<a;e++)t[e]===r&&t.splice(e,1);if(t.length<1&&r&&(t[0]=parsePart("General"),t[0].generated=!0),t.length<2){const s=parsePart(t[0].pattern);s.tokens.unshift({type:"minus",volatile:!0}),s.generated=!0,t.push(s)}if(t.length<3){const s=parsePart(t[0].pattern);s.generated=!0,t.push(s)}if(t.length<4)if(r)t.push(r);else{const s=parsePart("@");s.generated=!0,t.push(s)}t[0].condition=[">",0],t[1].condition=["<",0],t[2].condition=null}return{pattern:e,partitions:t,locale:n}}function parseCatch(a){try{return parsePattern(a)}catch(e){var t={tokens:[{type:"error"}]};return{pattern:a,partitions:[t,t,t,t],error:e.message,locale:null}}}const floor$1=Math.floor;function toYMD_1900(e){if((!(1<arguments.length&&void 0!==arguments[1])||arguments[1])&&0<=e){if(0===e)return[1900,1,0];if(60===e)return[1900,2,29];if(e<60)return[1900,e<32?1:2,(e-1)%31+1]}var e=e+68569+2415019,a=floor$1(4*e/146097),t=(e-=floor$1((146097*a+3)/4),floor$1(4e3*(1+e)/1461001)),e=e-floor$1(1461*t/4)+31,n=floor$1(80*e/2447),r=e-floor$1(2447*n/80),n=n+2-12*(e=floor$1(n/11));return[0|100*(a-49)+t+e,0|n,0|r]}function toYMD_1904(e){return toYMD_1900(e+1462)}function toYMD_1317(e){if(60===e)throw new Error("#VALUE!");if(e<=1)return[1317,8,29];if(e<60)return[1317,e<32?9:10,1+(e-2)%30];var e=e+466935,a=floor$1(e/10631),t=(e-=10631*a,floor$1((e-.1335)/(10631/30))),n=(e-=floor$1(t*(10631/30)+.1335),floor$1((28.5001+e)/29.5));return 13===n?[30*a+t,12,30]:[30*a+t,n,e-floor$1(29.5001*n-29)]}function toYMD(e){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,t=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],e=floor$1(e);return a===EPOCH_1317?toYMD_1317(e):a===EPOCH_1904?toYMD_1904(e):toYMD_1900(e,t)}const floor=Math.floor,DAYSIZE$1=86400;function dateToSerial(e,a){let t=null;var n,r,o,i,s,d;return Array.isArray(e)?([d,n,r,o,i,s]=e,t=Date.UTC(d,null==n?0:n-1,null!=r?r:1,o||0,i||0,s||0)):e instanceof Date&&(t=+e,a&&a.ignoreTimezone||(t-=60*e.getTimezoneOffset()*1e3)),null!=t&&isFinite(t)?(d=t/864e5)-(d<=-25509?-25568:-25569):e}function dateFromSerial(e,a){var t=0|e,t=DAYSIZE$1*(e-t);let n=floor(t);.9999<t-n&&(n+=1)===DAYSIZE$1&&(n=0);var t=n<0?DAYSIZE$1+n:n,[e,r,o]=toYMD(e,0,a&&a.leap1900),i=floor(t/60/60)%60,s=floor(t/60)%60,t=floor(t)%60;if(a&&a.nativeDate){const d=new Date(0);return d.setUTCFullYear(e,r-1,o),d.setUTCHours(i,s,t),d}return[e,r,o,i,s,t]}function clamp(e){if(0===e)return e;var a=Math.ceil(Math.log10(e<0?-e:e)),a=10**(16-Math.floor(a));return Math.round(e*a)/a}const zero={total:1,sign:0,period:0,int:1,frac:0};function numdec(e){var a=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=Math.abs(e);if(!n)return zero;var a=a&&e<0?1:0,e=Math.floor(n),r=Math.floor(Math.log10(n)+1);let o=0,i=0;if(e!==n){o=1;var s=String(round(r<0?n*10**-r:n/10**r,15));let e=s.length,a=!0,t=0;for(;t<=s.length;){if("."===s[t]){e--;break}"0"===s[t]&&a?e--:a=!1,t++}(i=e-r)<0&&(i=0,o=0)}return{total:a+Math.max(r,1)+o+i,digits:Math.max(r,0)+i,sign:a,period:o,int:Math.max(r,1),frac:i}}const fixLocale=(e,a)=>e.replace(/\./,a.decimal);function general(r,e,a,o){var i=0|a,e=a<0&&(!e.condition||"<>"===e.condition[0]||">="===e.condition[0]||">"===e.condition[0]);if("string"==typeof a)r.push(a);else if(a===i)e&&r.push(o.negative),r.push(Math.abs(i));else{e&&r.push(o.negative);let t=0;const s=Math.abs(a);let n=(t=s?Math.floor(Math.log10(s)):t)<0?s*10**-t:s/10**t;10===n&&(n=1,t++);i=numdec(s),e=()=>{var e=Math.abs(t);let a;a=1===n?n:round(n,5),r.push(fixLocale(a+"",o),o.exponent,t<0?o.negative:o.positive,e<10?"0":"",e)};-4<=t&&t<=-1?(a=s.toPrecision(10+t).replace(/0+$/,""),r.push(fixLocale(a,o))):10===t?(a=s.toFixed(10).slice(0,12).replace(/\.$/,""),r.push(fixLocale(a,o))):Math.abs(t)<=9?i.total<=11?(a=round(s,9).toFixed(i.frac),r.push(fixLocale(a,o))):9===t?r.push(Math.floor(s)):0<=t&&t<9?r.push(round(s,9-t)):e():12<=i.total?e():Math.floor(s)===s?r.push(Math.floor(s)):r.push(fixLocale(round(s,9).toFixed(i.frac),o))}return r}const DAYSIZE=86400,short_to_long={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},dateOverflows=(e,a)=>a?e<MIN_L_DATE||e>=MAX_L_DATE:e<MIN_S_DATE||e>=MAX_S_DATE;function runPart(t,n,r,o){let i="",s="",d="",l="",u="",a=0,m=0|t,p=0,c=0,f=1,h=0,g=0,_=0,y=0,b=0,v=0;const M=o||defaultLocale;if(!n.text&&isFinite(n.scale)&&1!==n.scale&&(t=clamp(t*n.scale)),n.exponential){let e=Math.abs(t);e&&(a=Math.round(Math.log10(e))),1<n.int_max&&(a=Math.floor(a/n.int_max)*n.int_max),e=a<0?e*10**-a:e/10**a,t=t<0?-e:e,i+=Math.abs(a)}var e;if(n.integer&&(e=Math.abs(round(t,n.fractions?1:n.frac_max)),u+=e<1?"":Math.floor(e)),n.grouping){let e="",a=u.length;for(a>n.group_pri&&(a-=n.group_pri,e=M.group+u.slice(a,a+n.group_pri)+e);a>n.group_sec;)a-=n.group_sec,e=M.group+u.slice(a,a+n.group_sec)+e;u=a?u.slice(0,a)+e:e}n.dec_fractions&&(l=String(round(t,n.frac_max)).split(".")[1]||"");let j=!1;if(!n.fractions||(e=Math.abs(n.integer?t%1:t))&&(j=!0,isFinite(n.denominator)?(d+=n.denominator,"0"===(s+=round(e*n.denominator))&&(s="",d="",j=!1,u=u||"0")):(e=dec2frac(e,n.integer?n.num_max:1/0,n.den_max),s+=e[0],d+=e[1],n.integer&&"0"===s&&(u=u||"0",s="",d="",j=!1))),n.date_eval&&dateOverflows(t,r.dateSpanLarge)){if(r.dateErrorThrows)throw new Error("Date out of bounds");return r.dateErrorNumber?general([],{},t,M).join(""):r.overflow}n.date&&(m=0|t,e=DAYSIZE*(t-m),p=Math.floor(e),v=e-p,Math.abs(v)<1e-6?v=0:.9999<v&&(v=0,(p+=1)===DAYSIZE&&(p=0,m+=1)),(m||n.date_system)&&(e=toYMD(t,n.date_system,r.leap1900),c=e[0],f=e[1],h=e[2]),(p||v)&&(((e=n.date&u_MSEC||n.date&u_CSEC||n.date&u_DSEC||n.date&u_SEC||n.date&u_MIN||n.date&u_HOUR)===u_MSEC&&.9995<v||e===u_CSEC&&.995<v||e===u_DSEC&&.95<v||e===u_SEC&&.5<=v||e===u_MIN&&.5<=v||e===u_HOUR&&.5<=v)&&(p++,v=0),e=p<0?DAYSIZE+p:p,b=Math.floor(e)%60,y=Math.floor(e/60)%60,_=Math.floor(e/60/60)%60),g=(6+m)%7),n.int_padding&&(u=1===n.int_padding.length?u||n.int_padding:n.int_padding.substring(0,n.int_padding.length-u.length)+u),n.num_padding&&(s=1===n.num_padding.length?s||n.num_padding:n.num_padding.substring(0,n.num_padding.length-s.length)+s),n.den_padding&&(d=1===n.den_padding.length?d||n.den_padding:d+n.den_padding.slice(d.length)),n.man_padding&&(e=n.exp_plus?"+":"",i=1===n.man_padding.length?(a<0?"-":e)+(i||n.man_padding):(a<0?"-":e)+n.man_padding.slice(0,n.man_padding.length-i.length)+i);const k=[];let x=0;const D={int:0,frac:0,man:0,num:0,den:0};for(let e=0,a=n.tokens.length;e<a;e++){const A=n.tokens[e];var F,S,E,C=A.num?A.num.length:0;if("string"===A.type)A.rule?"num"===A.rule?j?k.push(A.value):(0<n.num_min||0<n.den_min)&&k.push(A.value.replace(/./g,_numchars["?"])):"num+int"===A.rule?j&&u?k.push(A.value):0<n.den_min&&(u||n.num_min)&&k.push(A.value.replace(/./g,_numchars["?"])):"den"===A.rule&&(j?k.push(A.value):(0<n.den_min||0<n.den_min)&&k.push(A.value.replace(/./g,_numchars["?"]))):k.push(A.value);else if("error"===A.type)k.push(r.invalid);else if("point"===A.type)k.push(n.date?A.value:M.decimal);else if("general"===A.type)general(k,n,t,M);else if("exp"===A.type)k.push(M.exponent);else if("minus"===A.type)A.volatile&&n.date||(!A.volatile||n.fractions||!n.integer&&!n.dec_fractions||u&&"0"!==u||l)&&k.push(M.negative);else if("plus"===A.type)k.push(M.positive);else if("text"===A.type)k.push(t);else if("div"===A.type)j?k.push("/"):0<n.num_min||0<n.den_min?k.push(_numchars["?"]):k.push(_numchars["#"]);else if("int"===A.type)1===n.int_pattern.length?k.push(u):(T=x?n.int_pattern.join("").length-D.int:1/0,L=x===n.int_pattern.length-1?0:n.int_pattern.join("").length-(D.int+A.num.length),k.push(u.substring(u.length-T,u.length-L)),x++,D.int+=A.num.length);else if("frac"===A.type){var z=D.frac;for(let e=0;e<C;e++)k.push(l[e+z]||_numchars[A.num[e]]);D.frac+=C}else if(A.type in short_to_long)1===n[A.type+"_pattern"].length?("int"===A.type&&k.push(u),"frac"===A.type&&k.push(l),"man"===A.type&&k.push(i),"num"===A.type&&k.push(s),"den"===A.type&&k.push(d)):(k.push(short_to_long[A.type].slice(D[A.type],D[A.type]+C)),D[A.type]+=C);else if("year"===A.type)c<0&&k.push(M.negative),k.push(String(Math.abs(c)).padStart(4,"0"));else if("year-short"===A.type){var T=c%100;k.push(T<10?"0":"",T)}else if("month"===A.type)k.push(A.pad&&f<10?"0":"",f);else if("monthname-single"===A.type)n.date_system===EPOCH_1317?k.push(M.mmmm6[f-1].charAt(0)):k.push(M.mmmm[f-1].charAt(0));else if("monthname-short"===A.type)n.date_system===EPOCH_1317?k.push(M.mmm6[f-1]):k.push(M.mmm[f-1]);else if("monthname"===A.type)n.date_system===EPOCH_1317?k.push(M.mmmm6[f-1]):k.push(M.mmmm[f-1]);else if("weekday-short"===A.type)k.push(M.ddd[g]);else if("weekday"===A.type)k.push(M.dddd[g]);else if("day"===A.type)k.push(A.pad&&h<10?"0":"",h);else if("hour"===A.type){var L=_%n.clock||(n.clock<24?n.clock:0);k.push(A.pad&&L<10?"0":"",L)}else if("min"===A.type)k.push(A.pad&&y<10?"0":"",y);else if("sec"===A.type)k.push(A.pad&&b<10?"0":"",b);else if("subsec"===A.type){k.push(M.decimal);const P=v.toFixed(n.sec_decimals);k.push(P.slice(2,2+A.decimals))}else"am"===A.type?(F=_<12?0:1,A.short&&!o?k.push("AP"[F]):k.push(M.ampm[F])):"hour-elap"===A.type?(t<0&&k.push(M.negative),F=24*m+Math.floor(Math.abs(p)/3600),k.push(String(Math.abs(F)).padStart(A.pad,"0"))):"min-elap"===A.type?(t<0&&k.push(M.negative),S=1440*m+Math.floor(Math.abs(p)/60),k.push(String(Math.abs(S)).padStart(A.pad,"0"))):"sec-elap"===A.type?(t<0&&k.push(M.negative),S=m*DAYSIZE+Math.abs(p),k.push(String(Math.abs(S)).padStart(A.pad,"0"))):"b-year"===A.type?k.push(c+543):"b-year-short"===A.type&&(E=(c+543)%100,k.push(E<10?"0":"",E))}return r.nbsp?k.join(""):k.join("").replace(/\u00a0/g," ")}function getPart(a,t){for(let e=0;e<3;e++){var n,r,o=t[e];if(o){let e;if(o.condition?(n=o.condition[0],r=o.condition[1],"="===n?e=a===r:">"===n?e=r<a:"<"===n?e=a<r:">="===n?e=r<=a:"<="===n?e=a<=r:"<>"===n&&(e=a!==r)):e=!0,e)return o}}}const default_text=parsePart("@"),default_color="black";function color(e,a){if("number"!=typeof e||!isFinite(e))return(a[3]||default_text).color||default_color;e=getPart(e,a);return e&&e.color||default_color}function formatNumber(e,a,t){var n=getLocale(t.locale),r=a[3]||default_text;if(null==(e="boolean"==typeof e?e?"TRUE":"FALSE":e))return"";if("number"!=typeof e)return runPart(e,r,t,n);if(!isFinite(e))return r=n||defaultLocale,isNaN(e)?r.nan:(e<0?r.negative:"")+r.infinity;r=getPart(e,a);return r?runPart(e,r,t,n):""}function isPercent(e){return!!(e[0]&&e[0].percent||e[1]&&e[1].percent||e[2]&&e[2].percent||e[3]&&e[3].percent)}function isDate(e){return!!(e[0]&&e[0].date||e[1]&&e[1].date||e[2]&&e[2].date||e[3]&&e[3].date)}function isText(e){var[e,a,t,n]=e;return!(e&&!e.generated||a&&!a.generated||t&&!t.generated||!n||!n.text||n.generated)}const level={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0},dateCodes=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]],reCurrencySymbols=/[¤$£¥֏؋৳฿៛₡₦₩₪₫€₭₮₱₲₴₸₹₺₼₽₾₿]/;function info(e){let a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;const[o,t]=e;var n=o.frac_max;const i={type:"general",isDate:isDate(e),isText:isText(e),isPercent:isPercent(e),maxDecimals:o.general?9:n,color:0,parentheses:0,grouped:o.grouping?1:0,partitions:e};e=!i.isDate&&!i.isText&&o.tokens.some(e=>"string"===e.type&&(a?e.value===a:reCurrencySymbols.test(e.value)));let s="G",d=0<=n?Math.min(15,n):"",r="",l="";if(t.color&&(l="-",i.color=1),o.parens&&(r="()",i.parentheses=1),e)s="C",i.type="currency";else if(i.isDate){let t=0,n=0,r="";o.tokens.forEach(e=>{const a=e.type;/^(b-)?year/.test(a)?(r+="Y",n++):a.startsWith("month")?(r+="M",n++):/^(week)?day/.test(a)?(r+="D",n++):"hour"!==a&&"min"!==a&&"sec"!==a&&"am"!==a||(r+=a[0],t++)}),i.type="date",n&&t?i.type="datetime":!n&&t&&(i.type="time");e=dateCodes.find(e=>r.startsWith(e[0]));s=e?"D":"G",d=e?e[1]:""}else i.isText?(s="G",i.type="text",d="",i.maxDecimals=0):o.general?(s="G",i.type="general",d=""):o.fractions?(s="G",i.type="fraction",d=""):o.exponential?(s="S",i.type="scientific"):i.isPercent?(s="P",i.type="percent"):o.grouping?(s=",",i.type="grouped"):(o.int_max||n)&&(s="F",i.type="number");return i.code=s+d+l+r,i.level=level[i.type],Object.freeze(i)}const okDateFormats=["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","M-d","M-j","d-F","d-M","n-d","n-j","j-F","j-M","M-Y","n-Y","m-d","F-d","m-j","F-j","m-Y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],dateTrie={};function packDate(e,a){var t;e?(a[t=e[0]]=a[t]||{},packDate(e.slice(1),a[t])):a.$=!0}okDateFormats.forEach(e=>{packDate(e,dateTrie),packDate(e+" x",dateTrie),packDate(e+" l",dateTrie),packDate(e+" l x",dateTrie),packDate("l "+e,dateTrie),packDate("l "+e+" x",dateTrie),packDate(e+" D",dateTrie),packDate(e+" D x",dateTrie),packDate("D "+e,dateTrie),packDate("D "+e+" x",dateTrie)});const monthsM={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},monthsF={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},days={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},currentYear=(new Date).getUTCFullYear();function parseNumber(l){l=/^([\s+%$(-]*)(((?:(?:\d[\d,]*)(?:\.\d*)?|(?:\.\d+)))([eE][+-]?\d+)?)([\s%$)]*)$/.exec(l);if(l){const[,p,c,f,h,g]=l;let a=1,e="",t=!1,n=!1,r=!1,o=!1,i=!1,s=!1,d=parseFloat(c.replace(/,/g,""));if(!isFinite(d))return null;for(let e=0;e<p.length;e++){var u=p[e];if("-"===u){if(t||n)return null;t=!0,a=-1}else if("$"===u){if(i)return null;i=!0}else if("("===u){if(n||t)return null;n=!0,a=-1}else if("%"===u){if(o)return null;o=!0}}for(let e=0;e<g.length;e++){var m=g[e];if("$"===m){if(i)return null;i=!0,s=!0}else if(")"===m){if(r||!n)return null;r=!0}else if("%"===m){if(o)return null;o=!0}}if(h){if(o||i)return null;e="0.00E+00"}else if(o){if(i)return null;e=f.includes(".")?"0.00%":"0%",d*=.01}else i?e=s?f.includes(".")?"#,##0.00$":"#,##0$":f.includes(".")?"$#,##0.00":"$#,##0":f.includes(",")&&(e=f.includes(".")?"#,##0.00":"#,##0");const _={v:d*a};return e&&(_.z=e),_}}function isValidDate(e,a,t){if(t<1)return!1;if(a<1||12<a)return!1;if(2===a){if((e%4==0&&e%100!=0||e%400==0||1900===e?29:28)<t)return!1}else if((4===a||6===a||9===a||11===a)&&30<t||(1===a||3===a||5===a||7===a||8===a||10===a||12===a)&&31<t)return!1;return!0}const nextToken=(t,n,r)=>{var o=r.path||"",i=Object.keys(n);for(let a=0;a<i.length;a++){let e;var s,d=i[a];if(n[d]){if("$"===d)t||(e=r);else if("-"===d){const c=/^(\s*([./-]|,\s)\s*|\s+)/.exec(t);c&&(s="-"===c[1]||"/"===c[1]||"."===c[1]?c[1]:" ",r.sep&&r.sep!==s||(l=c[0].replace(/\s+/g," "),e=nextToken(t.slice(c[0].length),n[d],{...r,sep:s,path:o+l})))}else if(" "===d){const f=/^[,.]?\s+/.exec(t);f&&(s=f[0].replace(/\s+/g," "),e=nextToken(t.slice(f[0].length),n[d],{...r,path:o+s}))}else if("j"===d||"d"===d){var l=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(t);l&&(e=nextToken(t.slice(l[0].length),n[d],{...r,day:l[0],path:o+d}))}else if("n"===d||"m"===d){var u=/^(0?[1-9]|1[012])\b/.exec(t);u&&(e=nextToken(t.slice(u[0].length),n[d],{...r,month:+u[0],_mon:u[0],path:o+d}))}else if("F"===d||"M"===d){const h=/^([a-z]{3,9})\b/i.exec(t);u=h&&("F"===d?monthsF:monthsM)[h[0].toLowerCase()];u&&(e=nextToken(t.slice(h[0].length),n[d],{...r,month:u,_mon:h[0],path:o+d}))}else if("l"===d||"D"===d){const g=/^([a-z]{3,9})\b/i.exec(t);(g&&days[g[0].toLowerCase()])===d&&(e=nextToken(t.slice(g[0].length),n[d],{...r,path:o+d}))}else if("y"===d){var m=/^\d\d\b/.exec(t);m&&(p=30<=+m[0]?+m[0]+1900:+m[0]+2e3,e=nextToken(t.slice(m[0].length),n[d],{...r,year:p,path:o+d}))}else if("Y"===d){m=/^\d\d\d\d\b/.exec(t);m&&(e=nextToken(t.slice(m[0].length),n[d],{...r,year:+m[0],path:o+d}))}else{if("x"!==d)throw new Error('Unknown date token "'.concat(d,'"'));var p=parseTime(t);p&&(e=nextToken("",n[d],{...r,time:p.v,tf:p.z,path:o+d}))}if(e)return e}}};function parseDate(a,t){const n=nextToken(a.trim(),dateTrie,{path:""});if(n){if("."===n.sep&&3===n.path.length)return null;a=+(null!=(a=n.year)?a:currentYear);if(n.day||(n.day=1),!isValidDate(a,n.month,n.day))return null;let e=-1/0;if(a<1900)return null;a<=1900&&n.month<=2?e=25568:a<1e4&&(e=25569);a=Date.UTC(a,n.month-1,n.day)/864e5+e+(n.time||0);if(0<=a&&a<=2958465){const o="0"===n._mon[0]||"0"===n.day[0]||2===n._mon.length&&2===n.day.length;var r=n.path.replace(/[jdlDnmMFyYx-]/g,e=>"j"===e||"d"===e?o?"dd":"d":"D"===e?"ddd":"l"===e?"dddd":"n"===e||"m"===e?o?"mm":"m":"M"===e?"mmm":"F"===e?"mmmm":"y"===e?"yy":"x"===e?n.tf||"":"Y"===e?"yyyy":e);return t&&t.nativeDate?{v:dateFromSerial(a,t),z:r}:{v:a,z:r}}}return null}function parseTime(a){a=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(a);if(a){var[,a,t,n,r,o]=a;if(r&&!n)return null;if(!o&&!t&&!n)return null;let e=+(a||0);if(o){if(13<=e)return null;"p"!==o[0]&&"P"!==o[0]||(e+=12)}return{v:(60*e*60+60*+(t||0)+ +(n||0)+ +(r||0))/86400,z:(2===a.length?"hh":"h")+":mm"+(n?":ss":"")+(o?" AM/PM":"")}}return null}function parseBool(e){return/^\s*true\s*$/i.test(e)?{v:!0}:/^\s*false\s*$/i.test(e)?{v:!1}:null}function parseValue(e,a){var t;return null!=(a=null!=(t=null!=(t=parseNumber(e))?t:parseDate(e,a))?t:parseTime(e))?a:parseBool(e)}const _cache={};function getFormatter(e,t){const{pattern:a,partitions:n,locale:r}=e,o=e=>{const a=Object.assign({},options(),t,e);return r&&(a.locale=r),a},i=(e,a)=>{a=o(a);return formatNumber(dateToSerial(e,a),n,a)};return i.color=(e,a)=>{return color(dateToSerial(e,o(a)),n)},i.info=info(n,(t||{}).currency),i.isPercent=()=>i.info.isPercent,i.isDate=()=>i.info.isDate,i.isText=()=>i.info.isText,i.pattern=a,e.error&&(i.error=e.error),i.options=o,i.locale=r||t&&t.locale||"",Object.freeze(i)}function numfmt(e,a){e=e||"General";let t=null;var n;return _cache[e]?t=_cache[e]:(n=Object.assign({},options(),a),(t=(n.throws?parsePattern:parseCatch)(e)).error||(_cache[e]=t)),getFormatter(t,a)}function format(e,a,t){t=t&&"object"==typeof t?t:{locale:t,throws:!(3<arguments.length&&void 0!==arguments[3]&&arguments[3])};return numfmt(e,t)(dateToSerial(a,t),t)}numfmt.isDate=e=>numfmt(e,{throws:!1}).isDate(),numfmt.isPercent=e=>numfmt(e,{throws:!1}).isPercent(),numfmt.isText=e=>numfmt(e,{throws:!1}).isText(),numfmt.info=(e,a)=>numfmt(e,{...a,throws:!1,...a}).info||null,numfmt.dateToSerial=dateToSerial,numfmt.dateFromSerial=dateFromSerial,numfmt.options=options,numfmt.dec2frac=dec2frac,numfmt.round=round,numfmt.codeToLocale=codeToLocale,numfmt.parseLocale=parseLocale,numfmt.getLocale=getLocale,numfmt.addLocale=(e,a)=>{a=parseLocale(a);return delete _cache[a.lang],delete _cache[a.language],addLocale(e,a)},numfmt.format=format,numfmt.is_date=numfmt.isDate,numfmt.parseNumber=parseNumber,numfmt.parseDate=parseDate,numfmt.parseTime=parseTime,numfmt.parseBool=parseBool,numfmt.parseValue=parseValue,module.exports=numfmt;
//# sourceMappingURL=numfmt.js.map
